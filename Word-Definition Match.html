<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Past Participle Flashcards</title>
<style>
  :root{
    --bg:#FDFBED;
    --ink:#222;
    --accent:#8A0000;
    --card:#fff;
    --ink-soft:#444;

    /* Card sizing defaults (mobile & fallback) */
    --card-min: 180px;           /* min width per card */
    --card-ratio: 180/220;       /* width/height ratio ≈ 0.818 */
    --card-radius: 16px;
    --card-shadow: 0 3px 10px rgba(0,0,0,.06);

    /* Typography defaults (mobile & fallback) */
    --fs-v1: 28px;               /* big verb on front */
    --fs-tag: 12px;
    --fs-value: 18px;            /* V2 line */
    --fs-v3: 24px;               /* V3 line */
    --fs-index: 12px;
    --fs-hint: 11px;
    --fs-label: 12px;
  }

  /* Desktop: make cards and text scale with viewport width, capping at original sizes */
  @media (min-width: 768px){
    :root{
      /* Cards can shrink below 180px on narrower desktop/iframes */
      --card-min: clamp(120px, 17vw, 180px);

      /* Text scales down with viewport, capped at original sizes */
      --fs-v1: clamp(18px, 1.8vw, 28px);
      --fs-value: clamp(14px, 1.2vw, 18px);
      --fs-v3: clamp(16px, 1.35vw, 24px);
      --fs-index: clamp(10px, .9vw, 12px);
      --fs-hint: clamp(9px, .8vw, 11px);
      --fs-label: clamp(10px, .9vw, 12px);
    }
  }

  *,*::before,*::after{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--ink);font-family:"MS Reference Sans Serif", system-ui, sans-serif;}

  header{max-width:1100px;margin:24px auto 0;padding:0 16px}
  h1{font-family:"MS Reference Sans Serif", sans-serif;letter-spacing:.5px;font-weight: 400; font-size:30px; margin:0 0 4px;color:#000}
  p.lead{margin:.25rem 0 1rem;color:var(--ink-soft)}

  .toolbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin:10px 0 18px}
  .btn{appearance:none;border:1px solid var(--accent);background:transparent;color:var(--accent);padding:10px 14px;border-radius:999px;font-weight:600;cursor:pointer;transition:all .2s ease;}
  .btn:hover{transform:scale(1.05);font-weight:600}
  .btn.active{background:var(--accent);color:#fff}
  .btn:focus{outline:none}
  .search{flex:1;min-width:200px}
  .search input{width:100%;padding:10px 12px;border:1px solid #c7b9b9;border-radius:12px}

  /* Key change: use vw-based clamp for card width and rely on aspect-ratio for height */
  .grid{
    max-width:1100px;margin:0 auto;padding:0 16px 40px;
    display:grid;
    grid-template-columns: repeat(auto-fill, minmax(var(--card-min), 1fr));
    gap:16px;
  }

  .card{perspective:1000px;cursor:pointer}
  .inner{
    position:relative;width:100%;
    /* Was fixed height: 220px — now responsive by ratio */
    aspect-ratio: var(--card-ratio);
    transform-style:preserve-3d;transition:transform .5s;
  }
  .card.flipped .inner{transform:rotateY(180deg)}

  .face{
    position:absolute;inset:0;border:1px solid rgba(139,0,2,.3);
    border-radius:var(--card-radius);background:var(--card);
    box-shadow:var(--card-shadow);
    display:flex;flex-direction:column;align-items:center;justify-content:center;
    padding:14px;backface-visibility:hidden
  }
  .front .v1{font-size:var(--fs-v1);font-weight:600}
  .front .tag{margin-top:8px;font-size:var(--fs-tag);color:var(--ink-soft)}
  .back{transform:rotateY(180deg)}
  .row{display:flex;gap:8px;align-items:baseline;margin:6px 0}
  .label{font-size:var(--fs-label);color:var(--ink-soft);width:28px;text-align:right}
  .value{font-size:var(--fs-value);font-weight:600}
  .row.v3 .value{font-size:var(--fs-v3);color:var(--accent)}

  .index{position:absolute;top:8px;left:10px;font-size:var(--fs-index);color:var(--ink-soft)}
  .hint{position:absolute;bottom:10px;right:12px;font-size:var(--fs-hint);color:var(--ink-soft)}

  .sr{position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

  #muteBtn{width:38px;height:38px;margin-left:10px;border:1px solid var(--accent);background:transparent center/22px 22px no-repeat;border-radius:999px;font-weight:600;cursor:pointer;display:none}
  #muteBtn:hover{transform:scale(1.1)}

  .speakBtn{
    position:absolute;top:8px;right:10px;width:34px;height:34px;
    border:1px solid var(--accent);border-radius:999px;
    background:#fff url('https://schredder222.github.io/Assets/Unmute.svg') center/18px 18px no-repeat;
    cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.1)
  }
  .speakBtn:hover{transform:scale(1.08)}
</style>
</head>
<body>
  <header>
    <h1>Past Participle Flashcards</h1>
    <p class="lead">Tap/click a card to flip between the infinitive (front) and its past participle.</p>
    <div class="toolbar">
      <button class="btn" id="resetOrder">Alphabetical</button>
      <button class="btn" id="shuffle">Shuffle</button>
      <button class="btn" id="flipAll">Flip All</button>
      <label class="search">
        <span class="sr">Search verbs</span>
        <input id="q" type="search" placeholder="Filter by verb… (e.g., take)" />
      </label>
      <button id="muteBtn" aria-label="Mute/Unmute" title="Mute/Unmute"></button>
    </div>
  </header>

  <main class="grid" id="grid" aria-live="polite"></main>

<script>
const VERBS = [
  { v1:"be", v2:"was/were", v3:"been" },
  { v1:"begin", v2:"began", v3:"begun" },
  { v1:"break", v2:"broke", v3:"broken" },
  { v1:"bring", v2:"brought", v3:"brought" },
  { v1:"build", v2:"built", v3:"built" },
  { v1:"buy", v2:"bought", v3:"bought" },
  { v1:"catch", v2:"caught", v3:"caught" },
  { v1:"choose", v2:"chose", v3:"chosen" },
  { v1:"come", v2:"came", v3:"come" },
  { v1:"do", v2:"did", v3:"done" },
  { v1:"drink", v2:"drank", v3:"drunk" },
  { v1:"drive", v2:"drove", v3:"driven" },
  { v1:"eat", v2:"ate", v3:"eaten" },
  { v1:"fall", v2:"fell", v3:"fallen" },
  { v1:"feel", v2:"felt", v3:"felt" },
  { v1:"find", v2:"found", v3:"found" },
  { v1:"fly", v2:"flew", v3:"flown" },
  { v1:"forget", v2:"forgot", v3:"forgotten" },
  { v1:"get", v2:"got", v3:"got/gotten" },
  { v1:"give", v2:"gave", v3:"given" },
  { v1:"go", v2:"went", v3:"gone" },
  { v1:"have", v2:"had", v3:"had" },
  { v1:"hear", v2:"heard", v3:"heard" },
  { v1:"hold", v2:"held", v3:"held" },
  { v1:"keep", v2:"kept", v3:"kept" },
  { v1:"know", v2:"knew", v3:"known" },
  { v1:"leave", v2:"left", v3:"left" },
  { v1:"make", v2:"made", v3:"made" },
  { v1:"meet", v2:"met", v3:"met" },
  { v1:"pay", v2:"paid", v3:"paid" },
  { v1:"put", v2:"put", v3:"put" },
  { v1:"read", v2:"read", v3:"read" },
  { v1:"run", v2:"ran", v3:"run" },
  { v1:"say", v2:"said", v3:"said" },
  { v1:"see", v2:"saw", v3:"seen" },
  { v1:"sell", v2:"sold", v3:"sold" },
  { v1:"send", v2:"sent", v3:"sent" },
  { v1:"set", v2:"set", v3:"set" },
  { v1:"sit", v2:"sat", v3:"sat" },
  { v1:"speak", v2:"spoke", v3:"spoken" },
  { v1:"spend", v2:"spent", v3:"spent" },
  { v1:"stand", v2:"stood", v3:"stood" },
  { v1:"take", v2:"took", v3:"taken" },
  { v1:"teach", v2:"taught", v3:"taught" },
  { v1:"tell", v2:"told", v3:"told" },
  { v1:"think", v2:"thought", v3:"thought" },
  { v1:"understand", v2:"understood", v3:"understood" },
  { v1:"wear", v2:"wore", v3:"worn" },
  { v1:"win", v2:"won", v3:"won" },
  { v1:"write", v2:"wrote", v3:"written" },
];

const grid = document.getElementById('grid');
const search = document.getElementById('q');
const shuffleBtn = document.getElementById('shuffle');
const resetBtn = document.getElementById('resetOrder');
const flipAllBtn = document.getElementById('flipAll');
const muteBtn = document.getElementById('muteBtn');
let flippedAll = false;

const uiClick = new Audio("https://cdn.pixabay.com/download/audio/2024/04/21/audio_1b8d3bcd3d.mp3?filename=click-buttons-ui-menu-sounds-effects-button-7-203601.mp3");
uiClick.volume = 0.4;

// New sound just for Flip All / Unflip All
const flipAllSound = new Audio("https://cdn.pixabay.com/download/audio/2025/07/30/audio_b3087a581e.mp3");
flipAllSound.volume = 0.3;

const bgMusic = new Audio("https://cdn.pixabay.com/download/audio/2025/06/13/audio_cd802a7e4b.mp3");
bgMusic.loop = true;
bgMusic.volume = 0.1;
let musicStarted = false;

const ICON_MUTE = "https://schredder222.github.io/Assets/Mute.svg";
const ICON_UNMUTE = "https://schredder222.github.io/Assets/Unmute.svg";

function setMuteIcon(){
  muteBtn.style.backgroundImage = `url(${bgMusic.muted ? ICON_MUTE : ICON_UNMUTE})`;
}

// --- Pronunciation ---
const OVERRIDE_PRONUNCIATION = { 'read': 'red' };
function playPronunciation(v3){
  if(!('speechSynthesis' in window)) return;
  const phrase = (v3 || '').toString().replace(/\//g, ' or ').trim();
  const override = OVERRIDE_PRONUNCIATION[phrase.toLowerCase()] || phrase;
  const u = new SpeechSynthesisUtterance(override);
  u.lang = 'en-AU'; u.rate = 0.95; u.pitch = 1.0; u.volume = 1.0;
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

function createCard(v, i){
  const card = document.createElement('article');
  card.className = 'card';
  card.tabIndex = 0;
  card.setAttribute('role','button');
  card.setAttribute('aria-label', `${v.v1}: show past forms`);

  const inner = document.createElement('div');
  inner.className = 'inner';

  const front = document.createElement('div');
  front.className = 'face front';
  front.innerHTML = `
    <span class="index">#${String(i+1).padStart(2,'0')}</span>
    <div class="v1">${v.v1}</div>
    <div class="tag">Infinitive (V1)</div>
    <div class="hint">Click / tap to flip</div>
  `;

  const back = document.createElement('div');
  back.className = 'face back';
  back.innerHTML = `
    <button class="speakBtn" aria-label="Play pronunciation" title="Play pronunciation"></button>
    <span class="index">#${String(i+1).padStart(2,'0')}</span>
    <div class="row"><span class="label">V2</span><span class="value">${v.v2}</span></div>
    <div class="row v3"><span class="label">V3</span><span class="value">${v.v3}</span></div>
    <div class="hint">Tap speaker for pronunciation</div>
  `;

  inner.appendChild(front);
  inner.appendChild(back);
  card.appendChild(inner);

  function handleFlip(){
    if(card.classList.contains('flipped')){
      card.classList.remove('flipped');
    } else {
      document.querySelectorAll('.card').forEach(c => c.classList.remove('flipped'));
      card.classList.add('flipped');
    }
    if(!musicStarted){ 
      bgMusic.play(); 
      musicStarted = true; 
      muteBtn.style.display = 'inline-block'; 
      setMuteIcon(); 
    }
  }
  card.addEventListener('click', handleFlip);
  card.addEventListener('keydown', (e)=>{ if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); handleFlip(); } });

  const speakBtn = back.querySelector('.speakBtn');
  speakBtn.addEventListener('click', (e)=>{ e.stopPropagation(); playPronunciation(v.v3); });
  speakBtn.addEventListener('keydown', (e)=>{ if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); e.stopPropagation(); playPronunciation(v.v3); }});

  return card;
}

function render(list){
  grid.innerHTML = '';
  list.forEach((v,i)=> grid.appendChild(createCard(v,i)));
}

function shuffle(arr){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]] = [a[j],a[i]];
  }
  return a;
}

let current = VERBS.slice();
render(current);

resetBtn.classList.add('active');

function playUIClick(){ uiClick.currentTime = 0; uiClick.play(); }

shuffleBtn.addEventListener('click', ()=>{
  playUIClick();
  current = shuffle(current);
  flippedAll = false;
  flipAllBtn.textContent = 'Flip All';
  render(current);
  shuffleBtn.classList.add('active');
  resetBtn.classList.remove('active');
});

resetBtn.addEventListener('click', ()=>{
  playUIClick();
  current = VERBS.slice();
  flippedAll = false;
  flipAllBtn.textContent = 'Flip All';
  render(current);
  resetBtn.classList.add('active');
  shuffleBtn.classList.remove('active');
});

flipAllBtn.addEventListener('click', ()=>{
  flipAllSound.currentTime = 0; 
  flipAllSound.play();
  const cards = Array.from(document.querySelectorAll('.card'));
  flippedAll = !flippedAll;
  cards.forEach(c=> c.classList.toggle('flipped', flippedAll));
  flipAllBtn.textContent = flippedAll ? 'Unflip All' : 'Flip All';
});

search.addEventListener('input', (e)=>{
  const q = e.target.value.toLowerCase().trim();
  const filtered = current.filter(v=>
    v.v1.includes(q) || v.v2.includes(q) || v.v3.toLowerCase().includes(q)
  );
  render(filtered);
});

muteBtn.addEventListener('click', ()=>{
  playUIClick();
  bgMusic.muted = !bgMusic.muted;
  setMuteIcon();
});
</script>
</body>
</html>
